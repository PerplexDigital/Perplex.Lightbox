{"version":3,"file":"bundle.umd.js","sources":["../../dist/perplex.lightbox.mjs","../src/index.js"],"sourcesContent":["/**\r\n * PerplexLightbox v1.0.3\r\n */\n\n/**\r\n * Component state\r\n */\nvar state = {\n  animFrameworks: {\n    gsap: false,\n    animejs: false\n  },\n  prevFocusElem: null,\n  ignoreFocus: false,\n  runningAnimations: {\n    container: null,\n    item: null\n  }\n};\n/**\r\n * Component functions\r\n */\n\nvar func = {\n  checkAnimationFramework: function () {\n    if (window.gsap) {\n      state.animFrameworks.gsap = true;\n    } else if (window.anime) {\n      state.animFrameworks.animejs = true;\n    }\n  },\n  killRunningAnimations: function () {\n    for (var forItem in state.runningAnimations) {\n      state.runningAnimations[forItem].kill();\n    }\n  },\n  staticAnimationCallbacks: {\n    onOpenBegin: function () {\n      this.runCallbacks(this.callbacks.onOpenBegin);\n    },\n    onOpenEnd: function () {\n      this.runCallbacks(this.callbacks.onOpenEnd);\n    },\n    onCloseBegin: function () {\n      this.runCallbacks(this.callbacks.onCloseBegin);\n    },\n    onCloseEnd: function () {\n      this.element.style.display = \"none\";\n      this.item.style.opacity = \"0\";\n      this.runCallbacks(this.callbacks.onCloseEnd);\n    }\n  }\n};\n/**\r\n * Class Lightbox\r\n */\n\nvar Lightbox = function Lightbox(elem, options) {\n  var this$1 = this;\n\n  if (elem && typeof elem !== 'object') {\n    throw new Error('Spefify an object as container');\n  }\n\n  if (elem.prevObject) {\n    elem = elem[0];\n  } // options passed\n\n\n  this.options = options || {};\n\n  if (this.options && typeof this.options !== 'object') {\n    throw new Error('Options is not an object');\n  }\n\n  this.element = elem;\n  this.item = this.element.querySelector('.js-lightboxElem');\n  this.closeButton = this.element.querySelector('.js-lightboxClose');\n  this.focusable = {\n    elements: [],\n    firstFocusable: null,\n    lastFocusable: null,\n    nextFocus: null,\n    prevFocusElem: null\n  };\n  this.callbacks = {\n    onOpenBegin: [],\n    onOpenEnd: [],\n    onCloseBegin: [],\n    onCloseEnd: []\n  }; // Animation properties\n\n  this.animationProps = {\n    duration: this.options.duration ? this.options.duration : 400,\n    item: {\n      gsapEaseOpen: this.options.gsapEaseOpen ? this.options.gsapEaseOpen : 'expo.out',\n      gsapEaseClose: this.options.gsapEaseClose ? this.options.gsapEaseClose : 'power1.in',\n      staticEaseOpen: this.options.staticEaseOpen ? this.options.staticEaseOpen : 'cubic-bezier(0.21, 0.49, 0.1, 0.99)',\n      staticEaseClose: this.options.staticEaseClose ? this.options.staticEaseClose : 'ease-in'\n    }\n  }; // gsap animatie/timeline mee kunnen geven (chasing sunsets)\n\n  this.addCallback(function () {\n    this$1.closeButton.focus();\n  }, 'onOpenBegin'); // Focus vorige element wanneer sluiten begint\n\n  this.addCallback(function () {\n    if (state.prevFocusElem) {\n      state.prevFocusElem.focus();\n    }\n  }, 'onCloseBegin');\n  this.closeOnEscape = this.closeOnEscape.bind(this);\n  this.closeOnClick = this.closeOnClick.bind(this);\n  this.trapFocus = this.trapFocus.bind(this);\n  this.close = this.close.bind(this);\n  this.getFocusableElements(); // static animations\n\n  this.static = {\n    onOpenBegin: func.staticAnimationCallbacks.onOpenBegin.bind(this),\n    onOpenEnd: func.staticAnimationCallbacks.onOpenEnd.bind(this),\n    onCloseBegin: func.staticAnimationCallbacks.onCloseBegin.bind(this),\n    onCloseEnd: func.staticAnimationCallbacks.onCloseEnd.bind(this)\n  };\n}; // open / close\n\n\nLightbox.prototype.open = function open () {\n  // store previously focussed item\n  state.prevFocusElem = document.activeElement; // apply close events (close on escape, etc)\n\n  this.addListeners(); // open the lightbox with GSAP\n\n  if (state.animFrameworks.gsap) {\n    state.runningAnimations.container = gsap.to(this.element, this.animationProps.duration / 1000, {\n      opacity: 1,\n      display: \"block\"\n    });\n    state.runningAnimations.item = gsap.fromTo(this.item, this.animationProps.duration / 1000, {\n      scale: 0.9,\n      opacity: 0\n    }, {\n      scale: 1,\n      opacity: 1,\n      ease: this.animationProps.item.gsapEaseOpen,\n      onStart: this.runCallbacks,\n      onStartParams: [this.callbacks.onOpenBegin],\n      onComplete: this.runCallbacks,\n      onCompleteParams: [this.callbacks.onOpenEnd]\n    });\n  } else {\n    this.element.style.display = \"block\";\n    this.element.style.animation = \"containerShow \" + (this.animationProps.duration / 1000) + \"s forwards\";\n    this.item.style.animation = \"itemShow \" + (this.animationProps.duration / 1000) + \"s \" + (this.animationProps.item.staticEaseOpen) + \" forwards\";\n  }\n};\n\nLightbox.prototype.close = function close () {\n  this.removeListeners();\n\n  if (state.animFrameworks.gsap) {\n    func.killRunningAnimations();\n    state.runningAnimations.container = gsap.to(this.element, this.animationProps.duration / 1500, {\n      opacity: 0,\n      display: \"none\"\n    });\n    state.runningAnimations.item = gsap.to(this.item, this.animationProps.duration / 1500, {\n      scale: 0.95,\n      opacity: 0,\n      ease: this.animationProps.item.gsapEaseClose,\n      onStart: this.runCallbacks,\n      onStartParams: [this.callbacks.onCloseBegin],\n      onComplete: this.runCallbacks,\n      onCompleteParams: [this.callbacks.onCloseEnd]\n    });\n  } else {\n    this.element.style.animation = \"containerHide \" + (this.animationProps.duration / 1500) + \"s forwards\";\n    this.item.style.animation = \"itemHide \" + (this.animationProps.duration / 1500) + \"s \" + (this.animationProps.item.staticEaseClose) + \" forwards\";\n  }\n}; // Callbacks\n\n\nLightbox.prototype.addCallback = function addCallback (callback, moment) {\n  if (typeof callback !== 'function') {\n    throw new Error('callback must be a function');\n  }\n\n  if (moment && typeof moment !== 'string') {\n    throw new Error('moment must be a string');\n  }\n\n  moment = moment || 'onCloseEnd';\n\n  if (moment !== 'onOpenBegin' && moment !== 'onOpenEnd' && moment !== 'onCloseBegin' && moment !== 'onCloseEnd') {\n    throw new Error(\"moment must be either 'onOpenBegin', 'onOpenEnd', 'onCloseBegin', 'onCloseEnd'\");\n  }\n\n  this.callbacks[moment].push(callback);\n};\n\nLightbox.prototype.runCallbacks = function runCallbacks (callbackArr) {\n  for (var i = 0, list = callbackArr; i < list.length; i += 1) {\n    var callback = list[i];\n\n      callback(this);\n  }\n}; // Focus within lightbox\n\n\nLightbox.prototype.getFocusableElements = function getFocusableElements () {\n  this.focusable = this.element.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');\n  this.focusable.firstFocusable = this.focusable[0];\n  this.focusable.lastFocusable = this.focusable[this.focusable.length - 1];\n};\n\nLightbox.prototype.trapFocus = function trapFocus (e) {\n  if (e.key === 'Tab' || e.keyCode === 9) {\n    if (e.shiftKey) {\n      if (document.activeElement === this.focusable.firstFocusable) {\n        this.focusable.lastFocusable.focus();\n        e.preventDefault();\n      }\n    } else {\n      if (document.activeElement === this.focusable.lastFocusable) {\n        this.focusable.firstFocusable.focus();\n        e.preventDefault();\n      }\n    }\n  }\n}; // Event listeners\n\n\nLightbox.prototype.addListeners = function addListeners () {\n  document.addEventListener('keyup', this.closeOnEscape);\n  document.addEventListener('keydown', this.trapFocus, true);\n  this.closeButton.addEventListener('click', this.close);\n  this.element.addEventListener('click', this.closeOnClick); // Static animations\n\n  if (!state.animFrameworks.gsap) {\n    this.element.removeEventListener('animationstart', this.static.onCloseBegin);\n    this.element.removeEventListener('animationend', this.static.onCloseEnd);\n    this.element.addEventListener('animationstart', this.static.onOpenBegin);\n    this.element.addEventListener('animationend', this.static.onOpenEnd);\n  }\n};\n\nLightbox.prototype.removeListeners = function removeListeners () {\n  document.removeEventListener('keyup', this.closeOnEscape);\n  document.removeEventListener('keydown', this.trapFocus, true);\n  this.closeButton.removeEventListener('click', this.close);\n  this.element.removeEventListener('click', this.closeOnClick); // Static animations\n\n  if (!state.animFrameworks.gsap) {\n    this.element.removeEventListener('animationstart', this.static.onOpenBegin);\n    this.element.removeEventListener('animationend', this.static.onOpenEnd);\n    this.element.addEventListener('animationstart', this.static.onCloseBegin);\n    this.element.addEventListener('animationend', this.static.onCloseEnd);\n  }\n};\n\nLightbox.prototype.closeOnEscape = function closeOnEscape (e) {\n  if (e.key == 'Escape') {\n    this.close();\n  }\n};\n\nLightbox.prototype.closeOnClick = function closeOnClick (e) {\n  if (!e.target.closest(\".js-lightboxElem\")) {\n    this.close();\n  }\n}; // acties toevoegen als .on(\"close\", funciton...) zodat er bijvoorbeeld analytics events meegegeven worden.\n\n/**\r\n * Functions to execute on initialization\r\n */\n\n\nfunction onInit() {\n  func.checkAnimationFramework();\n  polyfills();\n}\n\nfunction polyfills() {\n  // closest\n  if (!Element.prototype.matches) {\n    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n  }\n\n  if (!Element.prototype.closest) {\n    Element.prototype.closest = function (s) {\n      var el = this;\n\n      do {\n        if (el.matches(s)) { return el; }\n        el = el.parentElement || el.parentNode;\n      } while (el !== null && el.nodeType === 1);\n\n      return null;\n    };\n  }\n}\n\nonInit();\n\nexport default Lightbox;\n","import Lightbox from '../../dist/perplex.lightbox';\r\n\r\nvar lightboxElem = $(\".js-lightbox\");\r\nvar myLightbox = new Lightbox(lightboxElem);\r\n\r\nwindow.PerplexLightbox = Lightbox;\r\n\r\n$(\".js-triggerBox\").on(\"click\", function() {\r\n\tmyLightbox.open();\r\n});"],"names":["state","animFrameworks","gsap","animejs","prevFocusElem","ignoreFocus","runningAnimations","container","item","func","checkAnimationFramework","window","anime","killRunningAnimations","forItem","kill","staticAnimationCallbacks","onOpenBegin","runCallbacks","this","callbacks","onOpenEnd","onCloseBegin","onCloseEnd","element","style","display","opacity","Lightbox","elem","options","this$1","Error","prevObject","querySelector","closeButton","focusable","elements","firstFocusable","lastFocusable","nextFocus","animationProps","duration","gsapEaseOpen","gsapEaseClose","staticEaseOpen","staticEaseClose","addCallback","focus","closeOnEscape","bind","closeOnClick","trapFocus","close","getFocusableElements","static","prototype","open","document","activeElement","addListeners","to","fromTo","scale","ease","onStart","onStartParams","onComplete","onCompleteParams","animation","removeListeners","callback","moment","push","callbackArr","i","list","length","querySelectorAll","e","key","keyCode","shiftKey","preventDefault","addEventListener","removeEventListener","target","closest","Element","matches","msMatchesSelector","webkitMatchesSelector","s","el","parentElement","parentNode","nodeType","myLightbox","$","PerplexLightbox","on"],"mappings":"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"}